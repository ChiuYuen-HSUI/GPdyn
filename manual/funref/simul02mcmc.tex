\subsection*{simul02mcmc} \label{fun:simul02mcmc}

\textbf{Syntax}
\\  \texttt{function [y, s2] = \\
\tab simul02mcmc(logtheta, covfunc, input, target, xt,lag)}

\textbf{Description}
\\ Simulation of the GP model, where the output variance is propagated using
 simple MCMC method, see A. Girard, Approximate Methods for
Propagation of  Uncertainty with Gaussian Process Models, PhD
thesis, 2004.
\\ Idea:
\\ at every time step the output of GP model is approximated with
 Nsamples samples, which are used as the future inputs of the GP
model.
 Samples are re-used if necessary (ie. y(k-1) for y(k-2) if lag=2
etc.) \\
 Uses routines gpr and mcmc\_getsamplesgaussianmix.
\\
\\ Inputs:
\\ loghteta .. optimized hyperparameters
\\ covfunc .. specified covariance function, see help covFun for more info
\\ input .. input part of the training data,  NxD matrix
\\ target .. output part of the training data (ie. target), Nx1 vector
\\ xt .. input matrix for simulation, kxD vector, see
  construct\_input\_matrix.m for more info
\\ lag .. the order of the model (number of used lagged outputs)
\\ Nsamples .. number of samples used in algorithm (ie. runs of simulation)
\\ Outputs:
\\ mu .. mean predicted output
\\ s2 .. asociated variances
\\ MU .. matrix of all predicted means, kxNsamples
\\ SIG2 .. associated predicted variances
\\ indexes\_warning .. sampling problems, see mcmc\_getsamplesgaussianmix.m
\\
\\ Written by K.Azman, 31.05.2005
\\ Based on the work of C.E. Rasmussen and A. Girard.
\\\textbf{Examples}
\\ demo\_narendra\_gp\_simulation.m
\\\textbf{See Also}
\\ GPR\_SIMUL, MCMC\_GETSAMPLESGAUSSIANMIX, SIMUL02NAIVE
